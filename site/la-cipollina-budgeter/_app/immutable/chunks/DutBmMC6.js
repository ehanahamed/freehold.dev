import{d as S,j as Ie,k as Ge,a as T,e as Je}from"./BiStlCBM.js";import{p as me,a0 as Ke,a2 as a,a4 as r,a as ye,a8 as Z,au as Y,a7 as R,aa as d,t as X,a5 as i,o as t,a3 as J,a6 as ue,a9 as he}from"./CuyIZn2s.js";import{s as F}from"./D1ZQew5F.js";import{i as W}from"./DI4tddXV.js";import{e as $,i as tt}from"./nELTDHYw.js";import{d as pe,s as Me,r as z,a as nt}from"./uNlJViDn.js";import{b as j}from"./CqxP_0jr.js";import{b as et}from"./CfXCE_Md.js";import{B as Be}from"./CxqwulL1.js";import{P as Ye}from"./sp7bv9Oi.js";import{C as q}from"./D7r-EodX.js";import{C as Xe}from"./MARklwlx.js";import{b as qe}from"./CbD5v4Kb.js";import{p as He}from"./Cexfq8rT.js";import{g as Et}from"./Kr6LqN9i.js";import{r as Qe}from"./CWPmrZZQ.js";import{d as Lt}from"./BepKD6Lw.js";import{d as Ve}from"./zuijxeg2.js";var Ze=S("<div><textarea></textarea></div>");function We(C,l){me(l,!0);let u=He(l,"value",15),v;function x(){v.style.height="auto",v.style.height=v.scrollHeight+"px"}Ke(()=>x());var w=Ze();pe(w,()=>({...l.div}));var h=a(w);Ie(h),pe(h,()=>{var p;return{...l.textarea,style:`overflow:hidden;resize:none;${((p=l.textarea)==null?void 0:p.style)??""??""}`}}),qe(h,p=>v=p,()=>v),r(w),j(h,u),Ge("input",h,x),T(C,w),ye()}var $e=S("<p>Record Day</p>"),ta=S("<p>Edit Day</p>"),ea=async(C,l,u,v,x,w,h,p,y)=>{const m=l.getDay();let P=new Date(l);m==0?P.setDate(l.getDate()-6):m!=1&&P.setDate(l.getDate()+1-m);let E=new Date(P);E.setDate(P.getDate()+6),typeof t(u)=="string"&&d(u,t(u).replaceAll(",",""),!0),isNaN(parseFloat(t(u)))?d(u,0):d(u,parseFloat(t(u)),!0),typeof t(v)=="string"&&d(v,t(v).replaceAll(",",""),!0),isNaN(parseFloat(t(v)))?d(v,0):d(v,parseFloat(t(v)),!0),typeof t(x)=="string"&&d(x,t(x).replaceAll(",",""),!0),isNaN(parseFloat(t(x)))?d(x,0):d(x,parseFloat(t(x)),!0);try{const O=await(await fetch(w.data.PUBLIC_API_URL+"/weeks",{method:"POST",headers:{Authorization:"Bearer "+localStorage.getItem("budgeter:auth"),"Content-Type":"application/json"},body:JSON.stringify({startDate:Lt(P),endDate:Lt(E),startFloorBudget:t(u),startKitchenBudget:t(v),startFoodBudget:t(x),weeklyPay:h})})).json();d(p,O,!0),d(y,!1)}catch(K){console.log(K),alert("idk something went wrong check ur wifi first")}},aa=S(`<p>Set this week's starting budget</p> <div style="border: 0.2rem solid var(--border); border-radius: 0.8rem;"><table style="border: none;" class="svelte-1rfit0"><thead><tr><th class="svelte-1rfit0"></th><th class="svelte-1rfit0">Floor Budget</th><th class="svelte-1rfit0">Kitchen Budget</th><th class="svelte-1rfit0">Food Budget</th></tr></thead><tbody><tr><td class="svelte-1rfit0">Start</td><td class="svelte-1rfit0"><div class="flex compact-gap nowrap" style="align-items: center; align-content: center;"><span>$</span> <input type="text" placeholder="0.00" class="svelte-1rfit0"/></div></td><td class="svelte-1rfit0"><div class="flex compact-gap nowrap" style="align-items: center; align-content: center;"><span>$</span> <input type="text" placeholder="0.00" class="svelte-1rfit0"/></div></td><td class="svelte-1rfit0"><div class="flex compact-gap nowrap" style="align-items: center; align-content: center;"><span>$</span> <input type="text" placeholder="0.00" class="svelte-1rfit0"/></div></td></tr></tbody></table> <div class="flex" style="padding-left: 1rem; padding-bottom: 1rem;"><button><!> Save</button></div></div>`,1),ra=S('<p>Do you want to increase any budget?</p> <div style="border: 0.2rem solid var(--border); border-radius: 0.8rem;"><table style="border: none;" class="svelte-1rfit0"><thead><tr><th class="svelte-1rfit0"></th><th class="svelte-1rfit0">Floor Budget</th><th class="svelte-1rfit0">Kitchen Budget</th><th class="svelte-1rfit0">Food Budget</th></tr></thead><tbody><tr><td class="svelte-1rfit0">Day Start</td><td class="svelte-1rfit0"> </td><td class="svelte-1rfit0"> </td><td class="svelte-1rfit0"> </td></tr><tr><td class="svelte-1rfit0">Increases</td><td class="svelte-1rfit0"><div class="flex compact-gap nowrap" style="align-items: center; align-content: center;"><span>$</span> <input type="text" placeholder="0.00" class="svelte-1rfit0"/></div></td><td class="svelte-1rfit0"><div class="flex compact-gap nowrap" style="align-items: center; align-content: center;"><span>$</span> <input type="text" placeholder="0.00" class="svelte-1rfit0"/></div></td><td class="svelte-1rfit0"><div class="flex compact-gap nowrap" style="align-items: center; align-content: center;"><span>$</span> <input type="text" placeholder="0.00" class="svelte-1rfit0"/></div></td></tr></tbody></table></div>',1),sa=S('<tr><td class="svelte-1rfit0"> </td><td class="svelte-1rfit0"><input type="text" style="min-width: 6rem; field-sizing: content;"/></td></tr>'),ia=S("<tr><th>Employee</th><th>Worked Today?</th></tr>"),la=(C,l)=>t(l).workedToday=!0,oa=(C,l)=>t(l).workedToday=!1,da=S('<tr><td class="svelte-1rfit0"> </td><td class="svelte-1rfit0"><div class="combo-select"><button><!> Yes</button> <button><!> No</button></div></td></tr>'),na=S('<tr><td class="svelte-1rfit0"> </td><td class="svelte-1rfit0"><input type="text" style="min-width: 6rem; field-sizing: content;"/></td></tr>'),ca=S("<tr><th>Employee</th><th>Worked Today?</th></tr>"),va=(C,l)=>t(l).workedToday=!0,fa=(C,l)=>t(l).workedToday=!1,_a=S('<tr><td class="svelte-1rfit0"> </td><td class="svelte-1rfit0"><div class="combo-select"><button><!> Yes</button> <button><!> No</button></div></td></tr>'),ua=S('<tr><td style="align-content: start; padding-right: 0px;" class="svelte-1rfit0"><div class="flex compact-gap nowrap" style="align-items: center; align-content: center;"><span>$</span> <input type="text" placeholder="0.00" style="min-width: 5rem; field-sizing: content;"/></div></td><td class="svelte-1rfit0"><!></td><td style="align-content: start; padding-left: 0px;" class="svelte-1rfit0"><button class="icon-only-button"><!></button></td></tr>'),ha=function(C,l){t(l).push({cost:"",notes:""})},pa=async(C,l,u,v,x,w,h,p,y,m,P,E)=>{if(t(l)){alert("Set this week's budget first (at the top of this page)");return}for(let n=0;n<u.length;n++)isNaN(parseFloat(u[n].hours))?u[n].hours=0:u[n].hours=parseFloat(u[n].hours);for(let n=0;n<v.length;n++)isNaN(parseFloat(v[n].hours))?v[n].hours=0:v[n].hours=parseFloat(v[n].hours);const K=u.concat(v),O=x.concat(w);for(let n=0;n<t(h).length;n++)typeof t(h)[n].cost=="string"&&(t(h)[n].cost=t(h)[n].cost.replaceAll(",",""),isNaN(parseFloat(t(h)[n].cost))?t(h)[n].cost=0:t(h)[n].cost=parseFloat(t(h)[n].cost));typeof t(p)=="string"?(d(p,t(p).replaceAll(",",""),!0),isNaN(parseFloat(t(p)))?d(p,0):d(p,parseFloat(t(p)),!0)):typeof t(p)!="number"&&d(p,0),typeof t(y)=="string"?(d(y,t(y).replaceAll(",",""),!0),isNaN(parseFloat(t(y)))?d(y,0):d(y,parseFloat(t(y)),!0)):typeof t(y)!="number"&&d(y,0),typeof t(m)=="string"?(d(m,t(m).replaceAll(",",""),!0),isNaN(parseFloat(t(m)))?d(m,0):d(m,parseFloat(t(m)),!0)):typeof t(m)!="number"&&d(m,0);try{if(P.data.new){const U=await(await fetch(P.data.PUBLIC_API_URL+"/days",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer "+localStorage.getItem("budgeter:auth")},body:JSON.stringify({date:E,hoursWorked:K,workedToday:O,foodCosts:t(h),foodBudgetIncrease:t(m),kitchenBudgetIncrease:t(y),floorBudgetIncrease:t(p)})})).json();(U==null?void 0:U.id)!=null?Et(`${et}/days/${E}`):(console.log(U),alert("hmmm there's some kind of error, check ur internet connection mabye"))}else{const U=await(await fetch(`${P.data.PUBLIC_API_URL}/days/${P.data.dayData.id}`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:"Bearer "+localStorage.getItem("budgeter:auth")},body:JSON.stringify({date:E,hoursWorked:K,workedToday:O,foodCosts:t(h),foodBudgetIncrease:t(m),kitchenBudgetIncrease:t(y),floorBudgetIncrease:t(p)})})).json();(U==null?void 0:U.id)!=null?Et(`${et}/days/${E}`):(console.log(U),alert("hmm there's an error, check ur internet connection mabye"))}}catch(n){console.error("Error while updating or adding day: ",n),alert("hmm something didn't work. check ur internet connection mabye idk")}},ma=S('<div class="grid page" style="margin-top: 4rem; margin-bottom: 10rem;"><div class="content"><div class="gridtablelayout svelte-1rfit0"><div class="areainfo svelte-1rfit0"><div style="text-align: center;"><!> <h3 style="margin-top: 0px; margin-bottom: 0px;"> </h3> <p style="margin-top: 0.2rem;"> </p></div></div> <div class="areaback svelte-1rfit0" style="margin-top: 0px"><a class="button faint"><!> Back</a></div> <div class="areabudget svelte-1rfit0" style="margin-top: 0px; margin-bottom: 1rem;"><!></div> <div class="areafloor svelte-1rfit0"><div class="flex" style="justify-content: space-between;"><p>Floor Workers</p> <p class="fg0"> </p></div> <table class="svelte-1rfit0"><thead><tr><th>Employee</th><th>Hours Worked</th></tr></thead><tbody><!><!><!></tbody></table></div> <div class="areakitchen svelte-1rfit0"><div class="flex" style="justify-content: space-between;"><p>Kitchen Workers</p> <p class="fg0"> </p></div> <table class="svelte-1rfit0"><thead><tr><th>Employee</th><th>Hours Worked</th></tr></thead><tbody><!><!><!></tbody></table></div> <div class="areafood svelte-1rfit0"><div class="flex" style="justify-content: space-between;"><p>Food Costs</p> <p class="fg0"> </p></div> <div style="border: 0.2rem solid var(--border); border-radius: 0.8rem;"><table style="border: none;" class="svelte-1rfit0"><thead><tr><th>Expenses</th><th>Notes</th></tr></thead><tbody><!><tr><td style="padding-right: 0px;" class="svelte-1rfit0"><button><!> Add</button></td></tr></tbody></table> <div style="padding: 0px 0px 1rem 1rem; margin-top: 0.6rem; font-size: 1.1rem;"> </div></div></div> <div class="areasave svelte-1rfit0"><button><!> Save</button></div></div></div></div>');function za(C,l){var ee,ae,re,se,ie,le,oe,de;me(l,!0);let u=Z([]),v=Z([]),x=Z([]),w=Z([]),h=R(0),p=R(0);const y=(()=>{var e;if((e=l.data)!=null&&e.date){const[s,f,o]=l.data.date.split("-"),c=new Date(s,f-1,o);if(!isNaN(c))return c}return new Date})(),m=Lt(y),P=["Sunday","Monday","Tuesday","Wednesday","Thrusday","Friday","Saturday"][y.getDay()],E=["sun","mon","tue","wed","thu","fri","sat"][y.getDay()],K=Ve(y);let O=[];l.data.new?(ae=(ee=l.data)==null?void 0:ee.employees)==null||ae.forEach(function(e){var s,f,o,c;(e==null?void 0:e.type)=="FLOOR"?(Y(h),e!=null&&e.specialPay?(((s=e.specialPay[E])==null?void 0:s.perDay)!=null&&v.push({employee:e,workedToday:!1}),((f=e.specialPay[E])==null?void 0:f.perHour)!=null&&u.push({employee:e,hours:""})):e!=null&&e.weeklyPay?O.push(e):u.push({employee:e,hours:""})):(e==null?void 0:e.type)=="KITCHEN"&&(Y(p),e!=null&&e.specialPay?(((o=e.specialPay[E])==null?void 0:o.perDay)!=null&&w.push({employee:e,workedToday:!1}),((c=e.specialPay[E])==null?void 0:c.perHour)!=null&&x.push({employee:e,hours:""})):e!=null&&e.weeklyPay?O.push(e):x.push({employee:e,hours:""}))}):((ie=(se=(re=l.data)==null?void 0:re.dayData)==null?void 0:se.hoursWorked)==null||ie.forEach(e=>{e.employee.type=="FLOOR"?(Y(h),u.push(e)):e.employee.type=="KITCHEN"&&(Y(p),x.push(e))}),(de=(oe=(le=l.data)==null?void 0:le.dayData)==null?void 0:oe.workedToday)==null||de.forEach(e=>{e.employee.type=="FLOOR"?(Y(h),v.push(e)):e.employee.type=="KITCHEN"&&(Y(p),v.push(e))}));let n=R(Z([{cost:"",notes:""}]));l.data.new||d(n,l.data.dayData.foodCosts,!0);let U=ue(()=>{var s;let e=0;return(s=t(n))==null||s.forEach(f=>{if(typeof f.cost=="string"){const o=parseFloat(f.cost.replaceAll(",",""));isNaN(o)||(e+=o)}else typeof f.cost=="number"&&(e+=f.cost)}),e}),A=R(null),at=R(!1),rt=R(!1),ct=R(""),vt=R(""),ft=R(""),H=[];try{fetch(l.data.PUBLIC_API_URL+`/weeks/${m}`,{method:"GET",headers:{Authorization:"Bearer "+localStorage.getItem("budgeter:auth")}}).then(e=>{e.json().then(s=>{if(s.statusCode==404)d(rt,!0),d(at,!0);else if(s){d(A,s,!0),d(at,!0);try{fetch(l.data.PUBLIC_API_URL+`/weeks/${m}/days`,{method:"GET",headers:{Authorization:"Bearer "+localStorage.getItem("budgeter:auth")}}).then(f=>{f.json().then(o=>{H=o})})}catch(f){console.error(f),alert("something went wrong idk ðŸ’€")}}else console.log(s),alert("something didn't work idk ðŸ’€")})})}catch(e){console.error(e),alert("something went wrong idk ðŸ’€")}(async function(){if(l.data.new)try{(await(await fetch(`${l.data.PUBLIC_API_URL}/days/${m}`,{method:"GET",headers:{Authorization:"Bearer "+localStorage.getItem("budgeter:auth")}})).json()).date==m&&Et(`${et}/edit-day/${m}`)}catch(e){console.error(e)}})();let _t=ue(()=>(H==null?void 0:H.length)>=1?Qe(t(A).startFoodBudget,t(A).startKitchenBudget,t(A).startFloorBudget,H):{foodBudget:t(A).startFoodBudget,kitchenBudget:t(A).startKitchenBudget,floorBudget:t(A).startFloorBudget}),st=R(""),it=R(""),lt=R("");l.data.new||(d(st,l.data.dayData.floorBudgetIncrease,!0),d(it,l.data.dayData.kitchenBudgetIncrease,!0),d(lt,l.data.dayData.foodBudgetIncrease,!0));var ut=ma(),Rt=a(ut),Ut=a(Rt),ht=a(Ut),Ct=a(ht),jt=a(Ct);{var ge=e=>{var s=$e();T(e,s)},be=e=>{var s=ta();T(e,s)};W(jt,e=>{l.data.new?e(ge):e(be,!1)})}var pt=i(jt,2),xe=a(pt,!0);r(pt);var zt=i(pt,2),ke=a(zt);r(zt),r(Ct),r(ht);var mt=i(ht,2),yt=a(mt),De=a(yt);Be(De,{}),J(),r(yt),r(mt);var gt=i(mt,2),Ne=a(gt);{var we=e=>{var s=aa(),f=i(he(s),2),o=a(f),c=i(a(o)),D=a(c),g=i(a(D)),b=a(g),_=i(a(b),2);z(_),r(b),r(g);var N=i(g),k=a(N),L=i(a(k),2);z(L),r(k),r(N);var I=i(N),Q=a(I),ot=i(a(Q),2);z(ot),r(Q),r(I),r(D),r(c),r(o);var V=i(o,2),M=a(V);M.__click=[ea,y,ct,vt,ft,l,O,A,rt];var dt=a(M);q(dt,{}),J(),r(M),r(V),r(f),j(_,()=>t(ct),G=>d(ct,G)),j(L,()=>t(vt),G=>d(vt,G)),j(ot,()=>t(ft),G=>d(ft,G)),T(e,s)},Fe=(e,s)=>{{var f=o=>{var c=ra(),D=i(he(c),2),g=a(D),b=i(a(g)),_=a(b),N=i(a(_)),k=a(N);r(N);var L=i(N),I=a(L);r(L);var Q=i(L),ot=a(Q);r(Q),r(_);var V=i(_),M=i(a(V)),dt=a(M),G=i(a(dt),2);z(G),r(dt),r(M);var Pt=i(M),ne=a(Pt),ce=i(a(ne),2);z(ce),r(ne),r(Pt);var ve=i(Pt),fe=a(ve),_e=i(a(fe),2);z(_e),r(fe),r(ve),r(V),r(b),r(g),r(D),X((B,Oe,Ae)=>{F(k,`$${B??""}`),F(I,`$${Oe??""}`),F(ot,`$${Ae??""}`)},[()=>t(_t).floorBudget.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2}),()=>t(_t).kitchenBudget.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2}),()=>t(_t).foodBudget.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})]),j(G,()=>t(st),B=>d(st,B)),j(ce,()=>t(it),B=>d(it,B)),j(_e,()=>t(lt),B=>d(lt,B)),T(o,c)};W(e,o=>{t(at)&&o(f)},s)}};W(Ne,e=>{t(at)&&t(rt)?e(we):e(Fe,!1)})}r(gt);var bt=i(gt,2),xt=a(bt),Ot=i(a(xt),2),Te=a(Ot);r(Ot),r(xt);var At=i(xt,2),It=i(a(At)),Gt=a(It);$(Gt,17,()=>u,tt,(e,s,f)=>{var o=sa(),c=a(o),D=a(c,!0);r(c);var g=i(c),b=a(g);z(b),r(g),r(o),X(()=>F(D,t(s).employee.name)),j(b,()=>t(s).hours,_=>t(s).hours=_),T(e,o)});var Jt=i(Gt);{var Se=e=>{var s=ia();T(e,s)};W(Jt,e=>{v.length>=1&&e(Se)})}var Pe=i(Jt);$(Pe,17,()=>v,tt,(e,s,f)=>{var o=da(),c=a(o),D=a(c,!0);r(c);var g=i(c),b=a(g),_=a(b);_.__click=[la,s];var N=a(_);q(N,{class:"combo-selected-icon"}),J(),r(_);var k=i(_,2);k.__click=[oa,s];var L=a(k);q(L,{class:"combo-selected-icon"}),J(),r(k),r(b),r(g),r(o),X(()=>{F(D,t(s).employee.name),nt(_,1,`left ${t(s).workedToday?"selected":""}`),nt(k,1,`right ${t(s).workedToday?"":"selected"}`)}),T(e,o)}),r(It),r(At),r(bt);var kt=i(bt,2),Dt=a(kt),Kt=i(a(Dt),2),Ee=a(Kt);r(Kt),r(Dt);var Mt=i(Dt,2),Bt=i(a(Mt)),Yt=a(Bt);$(Yt,17,()=>x,tt,(e,s,f)=>{var o=na(),c=a(o),D=a(c,!0);r(c);var g=i(c),b=a(g);z(b),r(g),r(o),X(()=>F(D,t(s).employee.name)),j(b,()=>t(s).hours,_=>t(s).hours=_),T(e,o)});var Xt=i(Yt);{var Le=e=>{var s=ca();T(e,s)};W(Xt,e=>{w.length>=1&&e(Le)})}var Re=i(Xt);$(Re,17,()=>w,tt,(e,s,f)=>{var o=_a(),c=a(o),D=a(c,!0);r(c);var g=i(c),b=a(g),_=a(b);_.__click=[va,s];var N=a(_);q(N,{class:"combo-selected-icon"}),J(),r(_);var k=i(_,2);k.__click=[fa,s];var L=a(k);q(L,{class:"combo-selected-icon"}),J(),r(k),r(b),r(g),r(o),X(()=>{F(D,t(s).employee.name),nt(_,1,`left ${t(s).workedToday?"selected":""}`),nt(k,1,`right ${t(s).workedToday?"":"selected"}`)}),T(e,o)}),r(Bt),r(Mt),r(kt);var Nt=i(kt,2),wt=a(Nt),qt=i(a(wt),2),Ue=a(qt);r(qt),r(wt);var Ht=i(wt,2),Ft=a(Ht),Qt=i(a(Ft)),Vt=a(Qt);$(Vt,17,()=>t(n),tt,(e,s,f)=>{var o=ua(),c=a(o),D=a(c),g=i(a(D),2);z(g),r(D),r(c);var b=i(c),_=a(b);We(_,{textarea:{placeholder:"Optional note for each expense",style:"width: 12rem;"},div:{style:"width: 12rem;"},get value(){return t(s).notes},set value(I){t(s).notes=I}}),r(b);var N=i(b),k=a(N);k.__click=()=>{t(n).splice(f,1)};var L=a(k);Xe(L,{}),r(k),r(N),r(o),j(g,()=>t(s).cost,I=>t(s).cost=I),T(e,o)});var Zt=i(Vt),Wt=a(Zt),Tt=a(Wt);Tt.__click=[ha,n];var Ce=a(Tt);Ye(Ce,{}),J(),r(Tt),r(Wt),r(Zt),r(Qt),r(Ft);var $t=i(Ft,2),je=a($t);r($t),r(Ht),r(Nt);var te=i(Nt,2),St=a(te);St.__click=[pa,rt,u,x,v,w,n,st,it,lt,l,m];var ze=a(St);q(ze,{}),J(),r(St),r(te),r(Ut),r(Rt),r(ut),X((e,s,f,o)=>{F(xe,P),F(ke,`${e??""} ${s??""}, ${f??""}${localStorage.getItem("budgeter:showWeekNums")=="true"?`, W${K}`:""}`),Me(yt,"href",l.data.new?et:`${et}/days/${m}`),F(Te,`${t(h)??""} employees`),F(Ee,`${t(p)??""} employees`),F(Ue,`${t(n).length??""} ${t(n).length==1?"item":"items"}`),F(je,`Total: $${o??""}`)},[()=>["January","February","March","April","May","June","July","August","September","October","November","December"][y.getMonth()],()=>y.getDate(),()=>y.getFullYear(),()=>t(U).toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})]),T(C,ut),ye()}Je(["click"]);export{za as E};
